import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

data = pd.read_csv('salary_data.csv')
X = data['YearsExperience'].values
y = data['Salary'].values

X_b = np.c_[np.ones(X.shape[0]), X]  # Add a column of ones for the intercept

learning_rate = 0.01
n_iterations = 1000

theta = np.random.randn(2)  # Random initialization

for iteration in range(n_iterations):
    predictions = X_b.dot(theta)
    errors = predictions - y
    gradients = 2 / len(y) * X_b.T.dot(errors)  
    theta -= learning_rate * gradients  

intercept, slope = theta

y_pred = X_b.dot(theta)

mse = np.mean((y_pred - y) ** 2)

print(f"Intercept: {intercept}, Slope: {slope}")
print(f"Mean Squared Error: {mse}")

plt.scatter(X, y, color='blue', label='Data points')
plt.plot(X, y_pred, color='red', label='Regression line')
plt.xlabel('Years of Experience')
plt.ylabel('Salary')
plt.title('Linear Regression: Years of Experience vs Salary')
plt.legend()
plt.show()
